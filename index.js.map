{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst CONFIG = {\n  baseURL: 'https://pixabay.com/api',\n  imagesPerPage: 15,\n};\naxios.defaults.baseURL = CONFIG.baseURL;\n\nasync function fetchApiData(queryValue, page = 1) {\n  const params = {\n    key: '47670925-140aa95f52ef27acd2496305c',\n    q: queryValue.trim(),\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: CONFIG.imagesPerPage,\n    page,\n  };\n\n  try {\n    const response = await axios.get(`/`, { params });\n    const { hits, totalHits } = response?.data || {};\n\n    return hits ? { images: hits, isNext: 15 * page < totalHits } : {};\n  } catch (error) {\n    console.error(\n      'Pixabay API fetch error: ',\n      error instanceof Error ? error.message : error\n    );\n\n    return [];\n  }\n}\n\nexport default fetchApiData;\n","const generateGalleryMarkup = images => {\n  return images.reduce(\n    (\n      acc,\n      { webformatURL, largeImageURL, tags, likes, views, comments, downloads }\n    ) => {\n      return (\n        acc +\n        `<li class=\"gallery-card\">\n              <a class=\"gallery-link\" href=\"${largeImageURL}\">\n                <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n                <ul class=\"gallery-card-info\">\n                  <li>\n                    <p>Likes</p>\n                    <p>${likes}</p>\n                  </li>\n                  <li>\n                    <p>Views</p>\n                    <p>${views}</p>\n                  </li>\n                  <li>\n                    <p>Comments</p>\n                    <p>${comments}</p>\n                  </li>\n                  <li>\n                    <p>Downloads</p>\n                    <p>${downloads}</p>\n                  </li>\n                </ul>\n              </a>\n            </li>`\n      );\n    },\n    ''\n  );\n};\n\nexport default generateGalleryMarkup;\n","import iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\nimport fetchApiData from './js/pixabay-api';\nimport generateGalleryMarkup from './js/render-functions';\n\nlet pageNumber, savedQueryValue;\n\nconst simpleLightboxInstance = new SimpleLightbox('a.gallery-link', {\n  captionDelay: 250,\n  overlayOpacity: 0.8,\n});\n\nconst DOM = {\n  form: document.querySelector('.js-form'),\n  gallery: document.querySelector('.js-gallery'),\n  loader: document.querySelector('.js-loader'),\n  loadMore: document.querySelector('.js-load-more-btn'),\n  lastPage: document.querySelector('.js-last-page-message'),\n};\n\nDOM.form.addEventListener('submit', submitHandler);\nDOM.loadMore.addEventListener('click', loadMoreImages);\n\nasync function submitHandler(event) {\n  event.preventDefault();\n  const queryValue = event.target.elements['user-query'].value.trim();\n\n  if (queryValue) {\n    showElement(DOM.loader);\n    savedQueryValue = queryValue;\n\n    const { images, isNext } = await fetchApiData(queryValue);\n\n    if (images?.length) {\n      DOM.gallery.innerHTML = generateGalleryMarkup(images);\n      simpleLightboxInstance.refresh();\n\n      isNext && showElement(DOM.loadMore);\n      hideElement(DOM.loader);\n\n      pageNumber = 2;\n      DOM.form.reset();\n    } else {\n      iziToastMessageHandler(\n        'Sorry, there are no images matching your search query. Please try again!'\n      );\n      hideElement(DOM.loader);\n      return;\n    }\n  } else {\n    iziToastMessageHandler('Search query cannot be empty.');\n    return;\n  }\n}\n\nasync function loadMoreImages() {\n  showElement(DOM.loader);\n  hideElement(DOM.loadMore);\n\n  const { images, isNext } = await fetchApiData(savedQueryValue, pageNumber);\n\n  if (images?.length === 0) {\n    showElement(DOM.lastPage);\n  } else if (images?.length) {\n    DOM.gallery.insertAdjacentHTML('beforeend', generateGalleryMarkup(images));\n    simpleLightboxInstance.refresh();\n    isNext ? showElement(DOM.loadMore) : showElement(DOM.lastPage);\n\n    smoothScroll();\n    pageNumber++;\n  }\n\n  hideElement(DOM.loader);\n}\n\nfunction smoothScroll() {\n  const card = document.querySelector('.gallery-card');\n  const height = card.getBoundingClientRect().height + 24;\n\n  window.scrollBy({\n    top: height * 2,\n    left: 0,\n    behavior: 'smooth',\n  });\n}\n\nfunction iziToastMessageHandler(message) {\n  iziToast.error({\n    message: message,\n    position: 'topRight',\n  });\n}\n\nfunction showElement(element) {\n  element.style.display = 'block';\n}\n\nfunction hideElement(element) {\n  element.style.display = 'none';\n}\n"],"names":["CONFIG","axios","fetchApiData","queryValue","page","params","response","hits","totalHits","error","generateGalleryMarkup","images","acc","webformatURL","largeImageURL","tags","likes","views","comments","downloads","pageNumber","savedQueryValue","simpleLightboxInstance","SimpleLightbox","DOM","submitHandler","loadMoreImages","event","showElement","isNext","hideElement","iziToastMessageHandler","smoothScroll","height","message","iziToast","element"],"mappings":"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"}